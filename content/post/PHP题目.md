---
title: "PHP题目"
date: 2021-05-25T13:08:00+08:00
lastmod: 2021-05-25T13:08:00+08:00
draft: false
tags: ["PHP","面试题"]
categories: ["技术"]

weight: 10
contentCopyright: MIT
mathjax: true
autoCollapseToc: true
---

> 业务问题

## 1. 商城秒杀的实现?

​	首先，抢购、秒杀是如今很常见的一个应用场景，主要需要解决的问题有两个：

1. 高并发对数据库产生的压力

> 利用缓存来处理抢购，避免直接操作数据库。例如：Redis。

2. 竞争状态下如何解决库存的正确减少（"超卖"问题）

> 如何保证库存的正确性？

要把秒杀的商品放入到队列，因为pop操作是原子性的，即使很多用户访问，也是依次执行。文件锁和事务在高并发下性能下降很快，所以不可取。

通过ajax调用接口，也可能会出现一个用户抢多次的情况，这时候需要加上一个排队队列，抢购结果队列，库存队列。先将用户进入队列，用一个线程循环处理从排队队列取出一个用户，判断用户是否在抢购结果队列，如果在，则已经抢购。否则未抢购，库存减1，写入数据库，将用户入结果队列。



## 2. 接口安全方面是怎么处理？

使用HTTP的POST方式,对固定参数+附加参数进行数字签名,使用的是md5加密,比如:我想通过标题获取一个信息,在客户端使用  信息标题+日期+双方约定好的一个key通过md5加密生成一个签名(sign),然后作为参数传递到服务器端,服务器端使用同样的方法进行校验,如何接受过来的sign和我们通过算法算的值相同，证明是一个正常的接口请求，我们才会返回相应的接口数据。

> PHP实现代码如下：

```php
public function actionGetSign(){
        $secret = 'hysjryg';
        $username = $_POST['username'];
        $password = $_POST['password'];
        $rand = rand(11111,99999);
        $time = time();
        //拼到数组里
        $arr = [
            'username' => $username,
            'password' => $password,
            'rand'=> $rand,
            'time'=> $time
        ];
        //进行排序
        ksort($arr);
        $str='';
        foreach ($arr as $k=>$v){
            $str .= "$k=$v&";
        }
        $last_str=substr($str,0,-1);
        //进行md5加密
        $md_str=md5($last_str);
        $sign=md5($md_str.$secret);
        return $sign;
    }
```

## 3. 在工作中遇到什么困难?

在工作我主要遇到这几个问题比较难处理：

1. 我之前工作的时候发现经常会出现一些临时需求打乱了我的计划，搞得有时候这个任务还没完成，又得去做其他的任务，最后一天下来，大大小小的东西是很多，但是没有完成得非常好的，后面我总结了一下，我会把这些都添加优先级，遇到临时需求，按照优先级重新将已有任务和临时任务进行排版，保证在规定时间内有效率的完成优先级高的任务。

2. 在做项目需求时候，遇到理解能力欠佳的人，沟通时容易被气到，影响自己的情绪，最后反倒还不能到达需要的效果。后面，每次到这种时候，我一般会借助一些纸质的、更加形象的东西，让双方都认同的、都能明白的一种方式来进行沟通，后面减少了很多不必须的麻烦。大家都知道，对于程序员来说，改需求是一件很痛苦的事情，所以前期的沟通工作很重要。

3. 还有一件事时，我以前的领导不太懂技术，所以每次出一个新的需求出来，总是要求我们在很短的时间内完成，完不成我们就会被怀疑能力有问题。当然，每个领导都希望自己的员工能够尽快的完成任务，降低成本，提高效率。这时候我会把我们的需求细化，把其中的重点、难点都列出来，做好时间规划，耐心的跟领导沟通，项目每个点的重要性和时间的花费比例，确保在这个规划的时间点内保质保量的完成任务。慢慢的也得到了领导的认可，其实领导也不是一味的不通情理，只要把东西计划好了，以最小的代价换取最高的价值，每个人都是很容易理解得

## 4. 索引的优缺点?

> 优点

a）可以保证数据库表中每一行的数据的唯一性

b）可以大大加快数据的索引速度

c）加速表与表之间的连接，物别是在实现数据的参考完事性方面特别有意义

d）在使用分组和排序子句进行数据检索时，同样可以显著减少查询中分组和排序的时间

f）通过使用索引，可以在时间查询的过程中，使用优化隐藏器，提高系统的性能

> 缺点

a)  创建索引和维护索引要耗费时间，这种时间随着数据量的增加而增加

b)  索引需要占物理空间，除了数据表占用数据空间之外，每一个索引还要占用一定的物理空间，如果需要建立聚簇索引，那么需要占用的空间会更大

c)  以表中的数据进行增、删、改的时候，索引也要动态的维护，这就降低了整数的维护速度

d)  建立索引的原则

e)  在经常需要搜索的列上，可以加快搜索的速度

f)  在作为主键的列上，强制该列的唯一性和组织表中数据的排列结构

g)  在经常用在连接的列上，这些列主要是一外键，可以加快连接的速度

h)  在经经常需要根据范围进行搜索的列上创建索引，国为索引已经排序，其指定的范围是连续的

i)  在经常需要排序的列上，国为索引已经排序，这样井底可以利用索引的排序，加快排序井底时间

j)  在经常使用在where子句中的列上，加快条件的判断速度
