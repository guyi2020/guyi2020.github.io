---
title: "MySQL主从复制"
date: 2021-05-23T13:08:00+08:00
lastmod: 2021-05-23T13:08:00+08:00
draft: false
tags: ["MySQL"]
categories: ["技术"]

weight: 10
contentCopyright: MIT
mathjax: true
autoCollapseToc: true
---

## 1. 概念

> MySQL数据库自身提供的主从复制功能可以方便的实现数据的多处自动备份，实现数据库的拓展。多个数据备份不仅可以加强数据的安全性，通过实现读写分离还能进一步提升数据库的负载性能。

​	一个多个数据库间主从复制与读写分离的模型(来源网络)：

![Local Picture](/blog/uploads/20210120/mysql1.jpg "MySQL主从复制与读写分离模型图")

在一主多从的数据库体系中，多个从服务器采用异步的方式更新主数据库的变化，业务服务器在执行写或者相关修改数据库的操作是在主服务器上进行的，读操作则是在各从服务器上进行。如果配置了多个从服务器或者多个主服务器又涉及到相应的负载均衡问题，关于负载均衡具体的技术细节还没有研究过，今天就先简单的实现一主一从的主从复制功能。

![Local Picture](/blog/uploads/20210120/mysql2.jpg "MySQL主从复制与读写分离模型图")

MySQL之间数据复制的基础是二进制日志文件（binary log  file）。一台MySQL数据库一旦启用二进制日志后，其作为master，它的数据库中所有操作都会以“事件”的方式记录在二进制日志中，其他数据库作为slave通过一个I/O线程与主服务器保持通信，并监控master的二进制日志文件的变化，如果发现master二进制日志文件发生变化，则会把变化复制到自己的中继日志中，然后slave的一个SQL线程会把相关的“事件”执行到自己的数据库中，以此实现从数据库和主数据库的一致性，也就实现了主从复制。



## 2. 实现MySQL主从复制需要进行的配置

- 主服务器：

  - 开启二进制日志
  - 配置唯一的server-id
  - 获得master二进制日志文件名及位置
  - 创建一个用于slave和master通信的用户账号

- 从服务器：

  - 配置唯一的server-id

- - 使用master分配的用户账号读取master二进制日志
  - 启用slave服务

